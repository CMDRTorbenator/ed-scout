<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>ED Scout {{ version }}</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="static/style.css?{{ timestamp }}">
    <link rel="stylesheet" type="text/css" href="css-overrides/css-overrides.css?{{ timestamp }}">


    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <link rel="stylesheet" type="text/css" href="static/icons/flaticon.css">


</head>

<body>



    <div class="container-fluid">
        <div class="row separator align-items-center">
            <div class="col"><hr class="separator"/></div>
            <div class="col-auto">Current Location</div>
            <div class="col"><hr class="separator"/></div>
        </div>
    </div>

    <div id="location-headings" class="container-fluid">
        <div class="row ml-1 mr-1 separator">
            <div class="col-3 text-center">Name</div>
            <div class="col">Type</div>
            <div class="col-auto text-center">Distance</div>
            <div class="col-1 text-center">Details</div>
            <div class="col-2 text-center">Mapped Value</div>
        </div>
    </div>

    <div id="location" data-currentSystem="" class="container-fluid">
        <div class="row ml-1 mr-1 align-items-center statusInfo">
            <div class="col system highlighted text-center">Unknown</div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row separator align-items-center">
            <div class="col"><hr class="separator"/></div>
            <div class="col-auto" id="nav-route-label">Nav Route</div>
            <div class="col"><hr class="separator"/></div>
        </div>
    </div>

    <div id="navroute-headings" class="container-fluid">
        <div class="row ml-1 mr-1 separator">
            <div class="col-3 text-center">Name</div>
            <div class="col">Type</div>
            <div class="col-2 text-center">Mapped Value</div>
        </div>
    </div>

    <div id="target-sys" data-target-sys="" class="container d-none">

    </div>

    <div id="nav-route" class="container-fluid">
        <div class="row ml-1 mr-1">
            <div class="col system highlighted text-center">Waiting for nav data...</div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row separator align-items-center">
            <div class="col"><hr class="separator"/></div>
        </div>
    </div>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.js"></script>
    <script>



        (function init() {


            function removeSystemFromNavList(systemId) {
                // Remove the system from the nav list
                let systemElement = document.getElementById(systemId);
                if (systemElement)
                {
                    systemElement.remove();
                }

                // Remove any valuable bodies too.

                let bodiesToRemove = document.querySelectorAll("[data-associatedsystem='"+systemId+"']");
                let bodyElement;
                console.log(bodiesToRemove);
                for (bodyElement of bodiesToRemove)
                {
                    bodyElement.remove();
                }
            }


            function setCurrentSystem(systemInfo) {
                console.log("Setting current");

                const systemId = systemInfo.SystemAddress;
                removeSystemFromNavList(systemId);

                let locationElement = document.getElementById('location');
                locationElement.innerHTML = "";
                locationElement.setAttribute('data-currentSystem', systemId);
            }

            function getCurrentSystem() {
                let locationElement = document.getElementById('location');
                if (locationElement.hasAttribute('data-currentSystem')) {
                    return locationElement.getAttribute('data-currentSystem');
                }
                else {
                    return null;
                }
            }

            function getCurrentlySelectedSystemElement()
            {
                let currentTarget = null;
                let locationElement = document.getElementById('target-sys');
                if (locationElement.hasAttribute('data-targetSystem'))
                {
                    currentTarget = locationElement.getAttribute('data-targetSystem')
                }
                return currentTarget;
            }

            function setTargetSystem(data) {
                console.log("Setting target system");
                let systemId = data.SystemAddress;
                let systemName = data.Name;

                // Record some data about this target so we can check it easily later
                let locationElement = document.getElementById('target-sys');
                locationElement.setAttribute('data-targetSystem', systemId.toString());
            }

            function startJumpTo(data) {
                if (data.JumpType !== "Hyperspace") {
                    // Don't do anything if we're just entering supercruise
                    console.log("Skipping jump");
                    return
                }

                console.log("Starting jump");

                // Clear the current location as we're now jumping
                let locationElement = document.getElementById('location');

                let content = document.createElement('div');
                content.classList.add("col","text-center", "highlighted");
                content.innerText = ">> Hyperspace <<";

                let row = document.createElement('div');
                row.classList.add("row", "ml-1", "mr-1");
                row.appendChild(content);

                locationElement.innerHTML = "";
                locationElement.appendChild(row);
            }

            function addScannedBody(payloadContent) {
                // { "timestamp":"2020-08-20T23:57:05Z", "event":"Scan", "ScanType":"Detailed", "BodyName":"Pro Eurl MO-H d10-11 2", "BodyID":27, "Parents":[ {"Star":0} ], "StarSystem":"Pro Eurl MO-H d10-11", "SystemAddress":388770122203, "DistanceFromArrivalLS":5502.835374, "TidalLock":false, "TerraformState":"", "PlanetClass":"Sudarsky class III gas giant", "Atmosphere":"", "AtmosphereComposition":[ { "Name":"Hydrogen", "Percent":74.636978 }, { "Name":"Helium", "Percent":25.363026 } ], "Volcanism":"", "MassEM":1115.081787, "Radius":76789080.000000, "SurfaceGravity":75.373241, "SurfaceTemperature":272.228607, "SurfacePressure":0.000000, "Landable":false, "SemiMajorAxis":1634133458137.512207, "Eccentricity":0.018997, "OrbitalInclination":-4.741432, "Periapsis":30.585864, "OrbitalPeriod":1122406125.068665, "RotationPeriod":113532.553386, "AxialTilt":-0.182964, "Rings":[ { "Name":"Pro Eurl MO-H d10-11 2 A Ring", "RingClass":"eRingClass_MetalRich", "MassMT":1.8852e+12, "InnerRad":1.1586e+08, "OuterRad":3.61e+08 } ], "ReserveLevel":"PristineResources", "WasDiscovered":false, "WasMapped":false }
                let container = document.getElementById('location');
                const newBodyEntry = createDetailedBodyEntry(payloadContent);
                container.appendChild(newBodyEntry);
                newBodyEntry.scrollIntoView();
            }

            function createIconElement(iconType, elementType='i') {
                let iconElement = document.createElement(elementType)
                iconElement.classList.add("flaticon-"+iconType)
                return iconElement
            }

            function getBodyIcon(bodyName) {
                let bodyIcon = "";
                let lowerBodyName = bodyName.toLowerCase();
                if (lowerBodyName.includes("metal")) {
                    bodyIcon = createIconElement("ingot").outerHTML
                }
                else if (lowerBodyName.includes("icy") || lowerBodyName.includes("ice")) {
                    bodyIcon = createIconElement("snowflake").outerHTML
                }
                else if (lowerBodyName.includes("earth")) {
                    bodyIcon = createIconElement("earth").outerHTML
                }
                else if (lowerBodyName.includes("gas giant")) {
                    bodyIcon = createIconElement("jupiter-1").outerHTML
                }
                else if (lowerBodyName.includes("rock")) {
                    bodyIcon = createIconElement("asteroid-3").outerHTML
                }
                else if (lowerBodyName.includes("water") || lowerBodyName.includes("ammonia world")) {
                    bodyIcon = createIconElement("water-drops").outerHTML
                }
                else if (lowerBodyName.includes("belt")) {
                    bodyIcon = createIconElement("asteroid-4").outerHTML
                }
                //rocky
                //gas
                return bodyIcon;
            }

            function numberWithCommas(x) {
                return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }

            function createFlagElement(iconName, activeIndicator) {
                const flagElementType = 'b';
                let element = createIconElement(iconName, flagElementType);
                if (!activeIndicator) {
                    element.classList.add("inactive")
                }
                else {
                    element.classList.add("active")
                }
                return element;
            }

            function createDetailedBodyEntry(payloadContent) {


                let discovered = payloadContent.WasDiscovered;
                let chartedStyle = discovered?"charted":"uncharted";
                let valuableSystem = payloadContent.MappedValue > 500000;
                if (valuableSystem) {
                    chartedStyle = "highlighted"
                }

                let spacer = document.createElement('div');
                spacer.classList.add("col-1", "system");

                let bodySymbol = "";
                if (payloadContent.PlanetClass) {
                    bodySymbol = createIconElement('jupiter-3').outerHTML;
                }
                else if (payloadContent.StarType) {
                    bodySymbol = createIconElement('star').outerHTML;
                }
                else {
                    if (payloadContent.BodyClass.includes("Belt")) {
                        bodySymbol = createIconElement('asteroid-4').outerHTML;
                    }
                }
                let bodyName = document.createElement('div');
                bodyName.classList.add("col-2", "system", chartedStyle, "text-left");
                bodyName.innerHTML = bodySymbol+" "+payloadContent.BodyName;

                let bodyType = document.createElement('div');
                bodyType.classList.add("col", "pr-0", "mr-0", "system", chartedStyle);
                if (payloadContent.PlanetClass) {
                    bodyType.innerHTML = getBodyIcon(payloadContent.PlanetClass)+" "+payloadContent.PlanetClass;
                }
                else if (payloadContent.StarType) {
                    bodyType.innerHTML = createIconElement('star').outerHTML+" "+payloadContent.StarType;
                }
                else if (payloadContent.BodyClass) {
                    bodyType.innerHTML = createIconElement('asteroid-4').outerHTML+" "+payloadContent.BodyClass;
                }

                let distance = document.createElement('div');
                // DistanceFromArrivalLS
                // numberWithCommas
                distance.classList.add("col-auto", "pl-2", "ml-0", "system", chartedStyle);
                distance.innerHTML = numberWithCommas(payloadContent.DistanceFromArrivalLS.toFixed(0)).toString();

                let extra_info = ""
                if (!payloadContent.StarType) {
                    const flagElementType = 'b';

                    extra_info += createFlagElement('volcano', payloadContent.Volcanism).outerHTML;
                    extra_info += createFlagElement('cooling-tower', payloadContent.TerraformState).outerHTML;
                    extra_info += createFlagElement('flag-outline-on-a-pole-with-stars-around', !payloadContent.WasMapped).outerHTML;
                    let landable = createFlagElement('lander', payloadContent.Landable);
                    landable.classList.add('landable');
                    extra_info += landable.outerHTML;
                }

                let bodyInfo = document.createElement('div');
                bodyInfo.classList.add("col-auto", "system", chartedStyle);
                bodyInfo.innerHTML = extra_info;

                let bodyValue = document.createElement('div');
                bodyValue.classList.add("col-2", "system", chartedStyle, "text-right");
                bodyValue.innerText = numberWithCommas(payloadContent.MappedValue);

                // De-select anything that's currently selected.
                let prevLatestScanElement = document.querySelector('.latest-scan');
                if (prevLatestScanElement) {
                    prevLatestScanElement.classList.remove('latest-scan');
                }

                let row = document.createElement('div');
                row.classList.add("row", "ml-1", "mr-1", "latest-scan");
                row.innerHTML =
                    spacer.outerHTML+
                    bodyName.outerHTML+
                    bodyType.outerHTML+
                    distance.outerHTML+
                    bodyInfo.outerHTML+
                    bodyValue.outerHTML;
                row.setAttribute('data-associatedsystem', payloadContent.SystemAddress);

                return row;
            }

            function createSystemEntry(systemInfo) {
                let row = document.createElement('div');
                row.classList.add("row", "ml-1", "mr-1");
                row.id = systemInfo.SystemAddress;
                let chartedSpecificStyle = systemInfo.charted?"charted":"uncharted";
                let mappedValue = systemInfo.charted?systemInfo.estimatedValueMapped:"?";

                let systemName = document.createElement('div');
                systemName.classList.add("col-3", "system", chartedSpecificStyle);
                systemName.innerHTML = createIconElement("solar-system").outerHTML+" "+systemInfo.StarSystem;

                let starClass = document.createElement('div');
                starClass.classList.add("col", "system", chartedSpecificStyle);
                starClass.innerHTML = (systemInfo.StarClass?systemInfo.StarClass+"-Class":"");

                let systemValue = document.createElement('div');
                systemValue.classList.add("col-2", "system", chartedSpecificStyle, "text-right");
                systemValue.innerText = numberWithCommas(mappedValue);

                row.innerHTML = systemName.outerHTML+starClass.outerHTML+systemValue.outerHTML;

                return row;
            }



            function createBodyEntry(body, system_id) {

                let spacer = document.createElement('div');
                spacer.classList.add("col-1", "system");

                let bodyName = document.createElement('div');
                bodyName.classList.add("col", "system", "charted");
                bodyName.innerHTML = createIconElement('jupiter-3').outerHTML+" "+body.bodyName;

                let bodyValue = document.createElement('div');
                bodyValue.classList.add("col-2", "system", "charted", "text-right");
                bodyValue.innerText = numberWithCommas(body.valueMax);

                let row = document.createElement('div');
                row.classList.add("row", "ml-1", "mr-1");
                row.innerHTML = spacer.outerHTML+bodyName.outerHTML+bodyValue.outerHTML;
                row.setAttribute('data-associatedsystem', system_id);

                return row;
            }

            function finishJump(data)
            {
                console.log("Finished jump");

                // Update the current system
                setCurrentSystem(data);
            }

            var navRouteContainer = document.getElementById('nav-route')

            function hideCurrentTarget() {
                // <div id="target-sys" data-target-sys="" class="container statusInfo d-none">
                let nextTargetContainer = document.getElementById('target-sys');
                nextTargetContainer.classList.add("d-none");
            }

            function showCurrentTarget() {
                // <div id="target-sys" data-target-sys="" class="container statusInfo d-none">
                let nextTargetContainer = document.getElementById('target-sys');
                if (nextTargetContainer.classList.contains("d-none"))
                {
                    nextTargetContainer.classList.remove("d-none");
                }
            }

            function addNewSystemToContainer(systemInfo, container) {
                                            // This needs to go in the nav list
                let systemEntry = createSystemEntry(systemInfo)
                container.appendChild(systemEntry);

                if (systemInfo.valuableBodies) {
                    let body;
                    for (body of systemInfo.valuableBodies) {

                        let nameText = body.bodyName;
                        const systemName = systemInfo['name'];
                        body.bodyName = nameText.replace(systemName, "");

                        console.log(body);
                        container.appendChild(createBodyEntry(body, systemInfo.SystemAddress));
                    }
                }
            }



            function postData(payload) {
                console.log(payload);
                let payloadContent = payload.data;
                if (payloadContent.type === 'NewRoute') {
                    console.log('Clearing');
                    navRouteContainer.innerHTML = '';
                    // If we're about to plot a new route, it'll set the next target as the first item in the navroute.
                    hideCurrentTarget();
                }
                else if (payloadContent.type === 'JournalEntry')
                {
                    switch(payloadContent.event)
                    {
                        case "FSDTarget": { // When you set a new jump target in the galaxy map
                            setTargetSystem(payloadContent);
                            break;
                        }
                        case "Location": {
                            setCurrentSystem(payloadContent);
                            break;
                        }
                        case "StartJump": { // When 3..2..1 starts
                            startJumpTo(payloadContent);
                            break;
                        }
                        case "FSDJump": { // When you drop out of hyperspace
                            finishJump(payloadContent);
                            break;
                        }
                        case "Scan": { // When you identify a body in the FSS
                            addScannedBody(payloadContent);
                            break;
                        }
                    }
                }
                else {
                    console.log('Processing system report', payloadContent)

                    if (payloadContent.type === 'System-NavRoute')
                    {
                        // If no current system set (or it matches the one that's already set because we just cleared it and we're waiting for the data to populate it), the first one we get should be current
                        let currentSystem = getCurrentSystem();
                        let container = null;
                        let systemId = payloadContent.SystemAddress.toString();
                        if ((currentSystem === null) || (currentSystem === "") || (currentSystem === systemId))
                        {
                            setCurrentSystem(payloadContent);
                            container = document.getElementById('location');
                        }
                        else
                        {
                            container = navRouteContainer;
                        }

                        addNewSystemToContainer(payloadContent, container)
                    }
                    else
                    {
                        // This is going to be oe of the other routines that wants a system report showing
                        if (payloadContent.type === 'System-FSDTarget')
                        {
                            // If this doesn't exist in the nav list, it's a unique target the commander has selected independently of the selected route
                            // As such, we need to...

                            // ...update the system in the target area
                            // NOTE: Make sure we clear the ID so it doesn't interfere with other checks (we can have systems in the target area that are also in the navlist).
                            let container = document.getElementById('target-sys');
                            container.innerHTML = "";

                            if (document.getElementById(payloadContent.SystemAddress)) {
                                // This element exists already so make sure the next-address is hidden
                                hideCurrentTarget();
                            }
                            else
                            {
                                showCurrentTarget();
                                addNewSystemToContainer(payloadContent, container);

                            }


                        }
                        else if ((payloadContent.type === 'System-Location') || // Update the system recorded in 'current system'
                            (payloadContent.type === 'System-FSDJump')) // Happens at the end of the jump so update the current system.
                        {
                            addNewSystemToContainer(payloadContent, document.getElementById('location'));
                        }


                    }
                }
            }

            var enableBackendConnections = true;

            // Uncomment to debug without needing the backend
            /**/

            function WrapWithEventType(type, entryContent) {
                let wrap = {'data': {'type': type}};
                wrap.data = $.extend(true, {}, wrap.data, entryContent);
                return wrap;
            }

            let tests = {};

            tests["just-startup"] = [
                // Simulate a normal startup
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:06Z", "event":"Location", "Docked":false, "StarSystem":"Sifeae EH-C c13-3", "SystemAddress":913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"V447 Lacertae", "BodyID":0, "BodyType":"Star" }),
            ];

            tests["planets-and-systems-listed-after-nav-route-sent"] = [
                // Simulate a normal startup
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:06Z", "event":"Location", "Docked":false, "StarSystem":"Sifeae EH-C c13-3", "SystemAddress":913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"V447 Lacertae", "BodyID":0, "BodyType":"Star" }),
                // Plot a nav route
                WrapWithEventType("NewRoute"),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl YJ-Q d5-18', "SystemAddress":629388954035, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Sifeae EH-C c13-3', 'SystemAddress': 913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], 'StarClass': 'K', 'id': 55216390, 'id64': 913385362290, 'name': 'Sifeae EH-C c13-3', 'url': 'https://www.edsm.net/en/system/bodies/id/55216390/name/Sifeae+EH-C+c13-3', 'estimatedValue': 112130, 'estimatedValueMapped': 368117, 'valuableBodies': [{'bodyId': 226907740, 'bodyName': 'Sifeae EH-C c13-3 A 1', 'distance': 1250, 'valueMax': 365696}], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl YJ-Q d5-18', 'SystemAddress': 629388954035, 'StarPos': [2035.6875, 381.59375, 739.6875], 'StarClass': 'F', 'id': 55108083, 'id64': 629388954035, 'name': 'Pro Eurl YJ-Q d5-18', 'url': 'https://www.edsm.net/en/system/bodies/id/55108083/name/Pro+Eurl+YJ-Q+d5-18', 'estimatedValue': 39863, 'estimatedValueMapped': 127197, 'valuableBodies': [], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl DV-E c12-2', 'SystemAddress': 637098300266, 'StarPos': [2083.0, 374.71875, 748.09375], 'StarClass': 'K', 'charted': false})
            ];

            tests["planets-and-systems-removed-when-jump-finishes"] = [
                // Simulate a normal startup
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:06Z", "event":"Location", "Docked":false, "StarSystem":"Sifeae EH-C c13-3", "SystemAddress":913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"V447 Lacertae", "BodyID":0, "BodyType":"Star" }),
                // Plot a nav route
                WrapWithEventType("NewRoute"),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl YJ-Q d5-18', "SystemAddress":629388954035, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Sifeae EH-C c13-3', 'SystemAddress': 913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], 'StarClass': 'K', 'id': 55216390, 'id64': 913385362290, 'name': 'Sifeae EH-C c13-3', 'url': 'https://www.edsm.net/en/system/bodies/id/55216390/name/Sifeae+EH-C+c13-3', 'estimatedValue': 112130, 'estimatedValueMapped': 368117, 'valuableBodies': [{'bodyId': 226907740, 'bodyName': 'Sifeae EH-C c13-3 A 1', 'distance': 1250, 'valueMax': 365696},{'bodyId': 226907741, 'bodyName': 'Sifeae EH-C c13-3 A 2', 'distance': 120, 'valueMax': 36596}], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl YJ-Q d5-18', 'SystemAddress': 629388954035, 'StarPos': [2035.6875, 381.59375, 739.6875], 'StarClass': 'F', 'id': 55108083, 'id64': 629388954035, 'name': 'Pro Eurl YJ-Q d5-18', 'url': 'https://www.edsm.net/en/system/bodies/id/55108083/name/Pro+Eurl+YJ-Q+d5-18', 'estimatedValue': 39863, 'estimatedValueMapped': 127197, 'valuableBodies': [{'bodyId': 226907740, 'bodyName': 'Pro Eurl YJ-Q d5-18 A 1', 'distance': 1250, 'valueMax': 365696},{'bodyId': 226907741, 'bodyName': 'Pro Eurl YJ-Q d5-18 A 2', 'distance': 120, 'valueMax': 36596}], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl DV-E c12-2', 'SystemAddress': 637098300266, 'StarPos': [2083.0, 374.71875, 748.09375], 'StarClass': 'K', 'charted': false}),
                // Do the jump
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:08:14Z", "event":"StartJump", "JumpType":"Hyperspace", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarClass":"M" }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl DV-E c12-2', "SystemAddress":637098300266, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:09:55Z", "event":"FSDJump", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarPos":[25.06250,13.53125,19.93750], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"Core Sys Sector ON-T b3-5 A", "BodyID":2, "BodyType":"Star", "JumpDist":51.088, "FuelUsed":7.591439, "FuelLevel":24.408562 })
            ];

            tests["planets-and-systems-removed-when-jump-finishes-after-missed-startup"] = [
                // Plot a nav route
                WrapWithEventType("NewRoute"),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl YJ-Q d5-18', "SystemAddress":629388954035, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Sifeae EH-C c13-3', 'SystemAddress': 913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], 'StarClass': 'K', 'id': 55216390, 'id64': 913385362290, 'name': 'Sifeae EH-C c13-3', 'url': 'https://www.edsm.net/en/system/bodies/id/55216390/name/Sifeae+EH-C+c13-3', 'estimatedValue': 112130, 'estimatedValueMapped': 368117, 'valuableBodies': [{'bodyId': 226907740, 'bodyName': 'Sifeae EH-C c13-3 A 1', 'distance': 1250, 'valueMax': 365696}], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl YJ-Q d5-18', 'SystemAddress': 629388954035, 'StarPos': [2035.6875, 381.59375, 739.6875], 'StarClass': 'F', 'id': 55108083, 'id64': 629388954035, 'name': 'Pro Eurl YJ-Q d5-18', 'url': 'https://www.edsm.net/en/system/bodies/id/55108083/name/Pro+Eurl+YJ-Q+d5-18', 'estimatedValue': 39863, 'estimatedValueMapped': 127197, 'valuableBodies': [], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl DV-E c12-2', 'SystemAddress': 637098300266, 'StarPos': [2083.0, 374.71875, 748.09375], 'StarClass': 'K', 'charted': false}),
                // Do the jump
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:08:14Z", "event":"StartJump", "JumpType":"Hyperspace", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarClass":"M" }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl DV-E c12-2', "SystemAddress":637098300266, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:09:55Z", "event":"FSDJump", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarPos":[25.06250,13.53125,19.93750], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"Core Sys Sector ON-T b3-5 A", "BodyID":2, "BodyType":"Star", "JumpDist":51.088, "FuelUsed":7.591439, "FuelLevel":24.408562 })
            ];

            tests["supercruise-not-cancelling-next-target"] = [
                // Plot a nav route
                WrapWithEventType("NewRoute"),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl YJ-Q d5-18', "SystemAddress":629388954035, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Sifeae EH-C c13-3', 'SystemAddress': 913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], 'StarClass': 'K', 'id': 55216390, 'id64': 913385362290, 'name': 'Sifeae EH-C c13-3', 'url': 'https://www.edsm.net/en/system/bodies/id/55216390/name/Sifeae+EH-C+c13-3', 'estimatedValue': 112130, 'estimatedValueMapped': 368117, 'valuableBodies': [{'bodyId': 226907740, 'bodyName': 'Sifeae EH-C c13-3 A 1', 'distance': 1250, 'valueMax': 365696}], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl YJ-Q d5-18', 'SystemAddress': 629388954035, 'StarPos': [2035.6875, 381.59375, 739.6875], 'StarClass': 'F', 'id': 55108083, 'id64': 629388954035, 'name': 'Pro Eurl YJ-Q d5-18', 'url': 'https://www.edsm.net/en/system/bodies/id/55108083/name/Pro+Eurl+YJ-Q+d5-18', 'estimatedValue': 39863, 'estimatedValueMapped': 127197, 'valuableBodies': [], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl DV-E c12-2', 'SystemAddress': 637098300266, 'StarPos': [2083.0, 374.71875, 748.09375], 'StarClass': 'K', 'charted': false}),
                // Do the jump
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:08:14Z", "event":"StartJump", "JumpType":"Hyperspace", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarClass":"M" }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl DV-E c12-2', "SystemAddress":637098300266, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:09:55Z", "event":"FSDJump", "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "StarPos":[25.06250,13.53125,19.93750], "SystemAllegiance":"", "SystemEconomy":"$economy_None;", "SystemEconomy_Localised":"None", "SystemSecondEconomy":"$economy_None;", "SystemSecondEconomy_Localised":"None", "SystemGovernment":"$government_None;", "SystemGovernment_Localised":"None", "SystemSecurity":"$GAlAXY_MAP_INFO_state_anarchy;", "SystemSecurity_Localised":"Anarchy", "Population":0, "Body":"Core Sys Sector ON-T b3-5 A", "BodyID":2, "BodyType":"Star", "JumpDist":51.088, "FuelUsed":7.591439, "FuelLevel":24.408562 }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-16T23:01:10Z", "event":"StartJump", "JumpType":"Supercruise" })
            ];



            tests["scans"] = [
                // Plot a nav route
                WrapWithEventType("NewRoute"),
                WrapWithEventType("JournalEntry", {"timestamp":"2020-08-08T23:07:12Z", "event":"FSDTarget", "Name":'Pro Eurl YJ-Q d5-18', "SystemAddress":629388954035, "StarClass":"F", "RemainingJumpsInRoute":1 }),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Sifeae EH-C c13-3', 'SystemAddress': 913385362290, 'StarPos': [2899.96875, 206.34375, 801.6875], 'StarClass': 'K', 'id': 55216390, 'id64': 913385362290, 'name': 'Sifeae EH-C c13-3', 'url': 'https://www.edsm.net/en/system/bodies/id/55216390/name/Sifeae+EH-C+c13-3', 'estimatedValue': 112130, 'estimatedValueMapped': 368117, 'valuableBodies': [], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl YJ-Q d5-18', 'SystemAddress': 629388954035, 'StarPos': [2035.6875, 381.59375, 739.6875], 'StarClass': 'F', 'id': 55108083, 'id64': 629388954035, 'name': 'Pro Eurl YJ-Q d5-18', 'url': 'https://www.edsm.net/en/system/bodies/id/55108083/name/Pro+Eurl+YJ-Q+d5-18', 'estimatedValue': 39863, 'estimatedValueMapped': 127197, 'valuableBodies': [], 'charted': true}),
                WrapWithEventType("System-NavRoute", {'StarSystem': 'Pro Eurl DV-E c12-2', 'SystemAddress': 637098300266, 'StarPos': [2083.0, 374.71875, 748.09375], 'StarClass': 'K', 'charted': false}),
                // Show some scans

                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T20:45:27Z", "event":"Scan", "MappedValue": 12345, "ScanType":"Detailed", "BodyName":"C 1", "BodyID":5, "Parents":[ {"Star":4}, {"Null":0} ], "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "DistanceFromArrivalLS":3952.286837, "TidalLock":true, "TerraformState":"", "PlanetClass":"High metal content body", "Atmosphere":"", "AtmosphereType":"None", "Volcanism":"", "MassEM":0.002846, "Radius":933771.437500, "SurfaceGravity":1.300979, "SurfaceTemperature":300.952332, "SurfacePressure":0.000000, "Landable":true, "Materials":[ { "Name":"iron", "Percent":23.895164 }, { "Name":"nickel", "Percent":18.073303 }, { "Name":"sulphur", "Percent":16.917128 }, { "Name":"carbon", "Percent":14.225550 }, { "Name":"phosphorus", "Percent":9.107442 }, { "Name":"vanadium", "Percent":5.867821 }, { "Name":"germanium", "Percent":4.995381 }, { "Name":"selenium", "Percent":2.647673 }, { "Name":"cadmium", "Percent":1.855568 }, { "Name":"molybdenum", "Percent":1.560341 }, { "Name":"technetium", "Percent":0.854634 } ], "Composition":{ "Ice":0.000000, "Rock":0.669572, "Metal":0.330428 }, "SemiMajorAxis":15086603164.672852, "Eccentricity":0.001070, "OrbitalInclination":-0.039211, "Periapsis":254.825325, "OrbitalPeriod":1905546.903610, "RotationPeriod":1905547.346105, "AxialTilt":-0.037440, "WasDiscovered":true, "WasMapped":true }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T20:45:53Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"C 6 a", "BodyID":11, "Parents":[ {"Planet":10}, {"Star":4}, {"Null":0} ], "StarSystem":"Pro Eurl YJ-Q d5-18", "SystemAddress":629388954035, "DistanceFromArrivalLS":4098.951070, "TidalLock":true, "TerraformState":"", "PlanetClass":"Rocky body", "Atmosphere":"", "AtmosphereType":"None", "Volcanism":"", "MassEM":0.000184, "Radius":396043.750000, "SurfaceGravity":0.466752, "SurfaceTemperature":174.171570, "SurfacePressure":0.000000, "Landable":true, "Materials":[ { "Name":"iron", "Percent":19.803368 }, { "Name":"sulphur", "Percent":17.687706 }, { "Name":"nickel", "Percent":14.978438 }, { "Name":"carbon", "Percent":14.873528 }, { "Name":"phosphorus", "Percent":9.522289 }, { "Name":"chromium", "Percent":8.906232 }, { "Name":"zinc", "Percent":5.381814 }, { "Name":"germanium", "Percent":5.222922 }, { "Name":"niobium", "Percent":1.353455 }, { "Name":"yttrium", "Percent":1.182832 }, { "Name":"tungsten", "Percent":1.087404 } ], "Composition":{ "Ice":0.000000, "Rock":0.859877, "Metal":0.140123 }, "SemiMajorAxis":36701788.902283, "Eccentricity":0.000000, "OrbitalInclination":41.570031, "Periapsis":124.557983, "OrbitalPeriod":755303.013325, "RotationPeriod":763516.619483, "AxialTilt":-0.465541, "WasDiscovered":false, "WasMapped":false }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T20:55:33Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"A 10", "BodyID":13, "Parents":[ {"Star":1}, {"Null":0} ], "StarSystem":"Sifeae RP-F d11-17", "SystemAddress":629388954035, "DistanceFromArrivalLS":5817.589961, "TidalLock":false, "TerraformState":"", "PlanetClass":"Icy body", "Atmosphere":"", "AtmosphereType":"None", "Volcanism":"", "MassEM":0.007883, "Radius":1628941.000000, "SurfaceGravity":1.184134, "SurfaceTemperature":107.449127, "SurfacePressure":0.000000, "Landable":true, "Materials":[ { "Name":"sulphur", "Percent":22.256582 }, { "Name":"carbon", "Percent":18.715481 }, { "Name":"iron", "Percent":16.512304 }, { "Name":"nickel", "Percent":12.489215 }, { "Name":"phosphorus", "Percent":11.981973 }, { "Name":"manganese", "Percent":6.819413 }, { "Name":"zinc", "Percent":4.487426 }, { "Name":"germanium", "Percent":3.436711 }, { "Name":"cadmium", "Percent":1.282255 }, { "Name":"niobium", "Percent":1.128528 }, { "Name":"tellurium", "Percent":0.890115 } ], "Composition":{ "Ice":0.617624, "Rock":0.256447, "Metal":0.125929 }, "SemiMajorAxis":1740140855312.347412, "Eccentricity":0.011868, "OrbitalInclination":9.222010, "Periapsis":353.753215, "OrbitalPeriod":1001487076.282501, "RotationPeriod":98751.115662, "AxialTilt":-0.519995, "WasDiscovered":false, "WasMapped":false }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T21:37:27Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"9", "BodyID":13, "Parents":[ {"Star":0} ], "StarSystem":"Sifeae RP-F d11-2", "SystemAddress":629388954035, "DistanceFromArrivalLS":3887.502778, "TidalLock":false, "TerraformState":"", "PlanetClass":"Rocky ice body", "Atmosphere":"thick nitrogen atmosphere", "AtmosphereType":"Nitrogen", "AtmosphereComposition":[ { "Name":"Nitrogen", "Percent":99.930611 }, { "Name":"Argon", "Percent":0.068962 } ], "Volcanism":"", "MassEM":0.241041, "Radius":4597476.000000, "SurfaceGravity":4.545296, "SurfaceTemperature":150.470886, "SurfacePressure":48670292.000000, "Landable":false, "Composition":{ "Ice":0.412583, "Rock":0.393262, "Metal":0.194155 }, "SemiMajorAxis":1061343133449.554443, "Eccentricity":0.111669, "OrbitalInclination":-144.826757, "Periapsis":67.346550, "OrbitalPeriod":509246402.978897, "RotationPeriod":130196.875286, "AxialTilt":-0.337840, "WasDiscovered":false, "WasMapped":false }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T22:25:32Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"5", "BodyID":48, "Parents":[ {"Star":0} ], "StarSystem":"Sifeae SP-F d11-19", "SystemAddress":629388954035, "DistanceFromArrivalLS":4348.969920, "TidalLock":false, "TerraformState":"", "PlanetClass":"Icy body", "Atmosphere":"thick methane rich atmosphere", "AtmosphereType":"MethaneRich", "AtmosphereComposition":[ { "Name":"Ammonia", "Percent":33.219345 }, { "Name":"Methane", "Percent":33.219345 }, { "Name":"Nitrogen", "Percent":33.219345 } ], "Volcanism":"water geysers volcanism", "MassEM":10.707685, "Radius":15074568.000000, "SurfaceGravity":18.780851, "SurfaceTemperature":485.114349, "SurfacePressure":4425951232.000000, "Landable":false, "Composition":{ "Ice":0.683452, "Rock":0.212104, "Metal":0.104443 }, "SemiMajorAxis":1302154421806.335449, "Eccentricity":0.002421, "OrbitalInclination":-1.029121, "Periapsis":53.665619, "OrbitalPeriod":795468407.869339, "RotationPeriod":74868.725071, "AxialTilt":-0.023235, "Rings":[ { "Name":"Sifeae SP-F d11-19 5 A Ring", "RingClass":"eRingClass_Icy", "MassMT":8.6698e+05, "InnerRad":2.4873e+07, "OuterRad":8.0814e+07 } ], "ReserveLevel":"PristineResources", "WasDiscovered":false, "WasMapped":false }),

                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T22:40:03Z", "event":"Scan", "MappedValue": 3123456, "ScanType":"Detailed", "BodyName":"4", "BodyID":4, "Parents":[ {"Star":0} ], "StarSystem":"Sifeae TP-F d11-27", "SystemAddress":629388954035, "DistanceFromArrivalLS":1202.383750, "TidalLock":false, "TerraformState":"Terraformable", "PlanetClass":"Water world", "Atmosphere":"nitrogen atmosphere", "AtmosphereType":"Nitrogen", "AtmosphereComposition":[ { "Name":"Nitrogen", "Percent":97.354683 }, { "Name":"Oxygen", "Percent":2.557643 }, { "Name":"Water", "Percent":0.063727 } ], "Volcanism":"major rocky magma volcanism", "MassEM":0.800711, "Radius":5696840.500000, "SurfaceGravity":9.833697, "SurfaceTemperature":249.786743, "SurfacePressure":387579.375000, "Landable":true, "Composition":{ "Ice":0.000000, "Rock":0.674676, "Metal":0.325323 }, "SemiMajorAxis":360511553287.506104, "Eccentricity":0.000180, "OrbitalInclination":-0.070908, "Periapsis":154.857116, "OrbitalPeriod":109780913.591385, "RotationPeriod":168794.241913, "AxialTilt":-0.165132, "WasDiscovered":false, "WasMapped":false }),

                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T22:42:20Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"7", "BodyID":12, "Parents":[ {"Star":0} ], "StarSystem":"Sifeae QU-F d11-7", "SystemAddress":629388954035, "DistanceFromArrivalLS":5808.033260, "TidalLock":false, "TerraformState":"", "PlanetClass":"Gas giant with ammonia based life", "Atmosphere":"", "AtmosphereComposition":[ { "Name":"Hydrogen", "Percent":74.353905 }, { "Name":"Helium", "Percent":25.625011 } ], "Volcanism":"", "MassEM":355.137878, "Radius":72255304.000000, "SurfaceGravity":27.112337, "SurfaceTemperature":132.713913, "SurfacePressure":0.000000, "Landable":false, "SemiMajorAxis":1737880468368.530273, "Eccentricity":0.014049, "OrbitalInclination":-0.175683, "Periapsis":319.387555, "OrbitalPeriod":1119854152.202606, "RotationPeriod":163062.787293, "AxialTilt":-0.328957, "Rings":[ { "Name":"Sifeae QU-F d11-7 4 A Ring", "RingClass":"eRingClass_MetalRich", "MassMT":1.0005e+11, "InnerRad":1.1772e+08, "OuterRad":1.3081e+08 }, { "Name":"Sifeae QU-F d11-7 4 B Ring", "RingClass":"eRingClass_Icy", "MassMT":1.343e+12, "InnerRad":1.3091e+08, "OuterRad":2.4653e+08 } ], "ReserveLevel":"PristineResources", "WasDiscovered":false, "WasMapped":false }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T22:43:17Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"2", "BodyID":3, "Parents":[ {"Null":2}, {"Star":0} ], "StarSystem":"Sifeae QU-F d11-7", "SystemAddress":629388954035, "DistanceFromArrivalLS":4160.962580, "TidalLock":false, "TerraformState":"", "PlanetClass":"Sudarsky class II gas giant", "Atmosphere":"", "AtmosphereComposition":[ { "Name":"Hydrogen", "Percent":74.369583 }, { "Name":"Helium", "Percent":25.630409 } ], "Volcanism":"", "MassEM":454.990814, "Radius":74923384.000000, "SurfaceGravity":32.305561, "SurfaceTemperature":165.127991, "SurfacePressure":0.000000, "Landable":false, "SemiMajorAxis":48908598.423004, "Eccentricity":0.044947, "OrbitalInclination":9.301607, "Periapsis":353.801388, "OrbitalPeriod":49028207.659721, "RotationPeriod":150021.407255, "AxialTilt":0.485325, "Rings":[ { "Name":"Sifeae QU-F d11-7 2 A Ring", "RingClass":"eRingClass_Rocky", "MassMT":2.1809e+11, "InnerRad":1.2237e+08, "OuterRad":1.5135e+08 }, { "Name":"Sifeae QU-F d11-7 2 B Ring", "RingClass":"eRingClass_Rocky", "MassMT":1.3414e+12, "InnerRad":1.5145e+08, "OuterRad":2.6776e+08 } ], "ReserveLevel":"PristineResources", "WasDiscovered":false, "WasMapped":false }),
                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T23:02:14Z", "event":"Scan", "MappedValue": 123, "ScanType":"Detailed", "BodyName":"AB 1", "BodyID":14, "Parents":[ {"Null":13}, {"Null":0} ], "StarSystem":"Sifeae SP-F d11-16", "SystemAddress":629388954035, "DistanceFromArrivalLS":4020.598838, "TidalLock":false, "TerraformState":"", "PlanetClass":"Sudarsky class III gas giant", "Atmosphere":"", "AtmosphereComposition":[ { "Name":"Hydrogen", "Percent":71.664436 }, { "Name":"Helium", "Percent":28.335575 } ], "Volcanism":"", "MassEM":2197.937988, "Radius":70825648.000000, "SurfaceGravity":174.640029, "SurfaceTemperature":597.157349, "SurfacePressure":0.000000, "Landable":false, "SemiMajorAxis":139971697.330475, "Eccentricity":0.197751, "OrbitalInclination":7.265513, "Periapsis":98.411227, "OrbitalPeriod":35178327.560425, "RotationPeriod":17075.715066, "AxialTilt":2.175150, "Rings":[ { "Name":"Sifeae SP-F d11-16 AB 1 A Ring", "RingClass":"eRingClass_MetalRich", "MassMT":2.1331e+11, "InnerRad":1.1453e+08, "OuterRad":1.4961e+08 }, { "Name":"Sifeae SP-F d11-16 AB 1 B Ring", "RingClass":"eRingClass_Rocky", "MassMT":4.2019e+12, "InnerRad":1.4971e+08, "OuterRad":4.5263e+08 } ], "ReserveLevel":"PristineResources", "WasDiscovered":false, "WasMapped":false }),

                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T20:58:37Z", "event":"Scan", "MappedValue": 1123456, "ScanType":"Detailed", "BodyName":"6", "BodyID":6, "Parents":[ {"Star":0} ], "StarSystem":"Sifeae RP-F d11-3", "SystemAddress":114143857123, "DistanceFromArrivalLS":3141.918552, "TidalLock":false, "TerraformState":"", "PlanetClass":"Ammonia world", "Atmosphere":"", "AtmosphereType":"AmmoniaOxygen", "AtmosphereComposition":[ { "Name":"CarbonDioxide", "Percent":84.502144 }, { "Name":"Nitrogen", "Percent":11.775880 }, { "Name":"Oxygen", "Percent":2.830044 } ], "Volcanism":"", "MassEM":0.296209, "Radius":4198024.500000, "SurfaceGravity":6.699115, "SurfaceTemperature":234.536438, "SurfacePressure":294524.968750, "Landable":false, "Composition":{ "Ice":0.000000, "Rock":0.673636, "Metal":0.326364 }, "SemiMajorAxis":942827576398.849487, "Eccentricity":0.001102, "OrbitalInclination":9.992684, "Periapsis":260.638759, "OrbitalPeriod":437092494.964600, "RotationPeriod":39129.182124, "AxialTilt":-0.224488, "WasDiscovered":false, "WasMapped":false }),

                WrapWithEventType("JournalEntry", { "timestamp":"2020-08-27T22:25:20Z", "event":"Scan", "MappedValue": 1, "ScanType":"AutoScan", "BodyName":"B 4", "BodyClass": "Belt Cluster", "BodyID":12, "Parents":[ {"Ring":8}, {"Star":0} ], "StarSystem":"Sifeae SP-F d11-19", "SystemAddress":663916448227, "DistanceFromArrivalLS":197.613961, "WasDiscovered":false, "WasMapped":false }),




            ];

            function runTest(testId){
                let data;
                for (data of tests[testId])
                {
                    postData(data);
                }
            }


            function addTest(testId) {
                let newButton = document.createElement('button')
                newButton.id = testId;
                newButton.innerText = testId;
                newButton.onclick = function() { runTest(testId); }

                document.body.appendChild(newButton);
                document.body.appendChild(document.createElement("br"))
            }

            let testId;
            for (testId of Object.keys(tests))
            {
                addTest(testId);
            }

            enableBackendConnections = false;

            /**/

            if (enableBackendConnections) {
                var socket = io()
                socket.on('log', postData)

                document.addEventListener('DOMContentLoaded', function() {
                    var url = 'http://'+window.location.hostname+':5001/GUI-is-still-open';
                    fetch(url, { mode: 'no-cors'});
                    setInterval(function(){ fetch(url, { mode: 'no-cors'});}, 5000);
                });
            }

        })()
    </script>


</body>

</html>